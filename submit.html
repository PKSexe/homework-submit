<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ“¸ ä¸Šè¼‰åœ–ç‰‡</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .container {
      background: rgba(255,255,255,0.96);
      border-radius: 20px;
      padding: 30px 24px;
      max-width: 420px;
      width: 100%;
      box-shadow: 0 20px 40px rgba(0,0,0,0.18);
      text-align: center;
    }
    h1 { font-size: 1.5rem; margin-bottom: 8px; color: #333; }
    .sub { font-size: 0.95rem; color: #666; margin-bottom: 20px; }
    input[type="text"], input[type="email"] {
      width: 100%; padding: 14px; margin-bottom: 14px;
      border-radius: 10px; border: 2px solid #e1e5f2; font-size: 15px;
    }
    input:focus { border-color: #667eea; outline: none; }
    .upload-box {
      border: 2px dashed #667eea;
      border-radius: 12px;
      padding: 18px 12px;
      margin: 14px 0;
      background: #f5f6ff;
    }
    .upload-btn {
      display: inline-block;
      padding: 10px 16px;
      border-radius: 999px;
      background: #667eea;
      color: #fff;
      font-size: 0.95rem;
      border: none;
      cursor: pointer;
      margin-bottom: 8px;
    }
    #fileName {
      font-size: 0.85rem; color: #555;
    }
    #preview {
      display: none;
      max-width: 100%;
      max-height: 180px;
      border-radius: 10px;
      margin-top: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }
    #submitBtn {
      width: 100%;
      margin-top: 12px;
      padding: 15px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg,#667eea,#764ba2);
      color: #fff;
      font-size: 1.05rem;
      font-weight: 600;
    }
    #status {
      margin-top: 10px;
      font-size: 0.9rem;
      padding: 8px 10px;
      border-radius: 8px;
      display: none;
    }
    .ok { background:#d4edda; color:#155724; }
    .err { background:#f8d7da; color:#721c24; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“¸ ä¸Šè¼‰åœ–ç‰‡</h1>
    <p class="sub">è¼¸å…¥èªè­‰ç¢¼åŠé›»éƒµï¼Œç„¶å¾Œé¸æ“‡ä¸€å¼µåœ–ç‰‡æäº¤</p>

    <input id="authCode" type="text" placeholder="èªè­‰ç¢¼ï¼ˆè€å¸«æä¾›ï¼‰" />
    <input id="email" type="email" placeholder="ä½ çš„é›»éƒµ" />

    <div class="upload-box">
      <button type="button" class="upload-btn" id="pickBtn">ğŸ“ é¸æ“‡åœ–ç‰‡</button>
      <div id="fileName">å°šæœªé¸æ“‡æª”æ¡ˆ</div>
      <input id="fileInput" type="file" accept="image/*" style="display:none" />
      <img id="preview" alt="é è¦½" />
      <div style="font-size:0.8rem;color:#888;margin-top:6px;">
        æ”¯æ´ JPG / PNGï¼Œæœ€å¤§ 10MB
      </div>
    </div>

    <button id="submitBtn">ğŸš€ ç«‹å³æäº¤</button>
    <div id="status"></div>
  </div>

  <script>
    const webhookUrl = 'https://hook.us2.make.com/8rhe48gjckwum4k9de3rqq06r39abhnp; // â† æ”¹æˆä½ çš„Webhook

    const pickBtn = document.getElementById('pickBtn');
    const fileInput = document.getElementById('fileInput');
    const fileName = document.getElementById('fileName');
    const preview = document.getElementById('preview');
    const submitBtn = document.getElementById('submitBtn');
    const statusBox = document.getElementById('status');

    pickBtn.onclick = () => fileInput.click();

    fileInput.onchange = e => {
      const file = e.target.files[0];
      if (!file) return;
      if (!file.type.startsWith('image/') || file.size > 10 * 1024 * 1024) {
        showStatus('âŒ è«‹é¸æ“‡ JPG/PNG ä¸¦å°æ–¼ 10MB', true);
        fileInput.value = '';
        preview.style.display = 'none';
        fileName.textContent = 'å°šæœªé¸æ“‡æª”æ¡ˆ';
        return;
      }
      fileName.textContent = `${file.name} (${(file.size/1024/1024).toFixed(1)} MB)`;
      preview.src = URL.createObjectURL(file);
      preview.style.display = 'block';
    };

    submitBtn.onclick = async () => {
      const authCode = document.getElementById('authCode').value.trim();
      const email = document.getElementById('email').value.trim();
      const file = fileInput.files[0];

      if (!authCode || !email || !file) {
        showStatus('âŒ è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½ä¸¦é¸æ“‡åœ–ç‰‡', true);
        return;
      }

      const fd = new FormData();
      fd.append('auth_code', authCode);
      fd.append('student_email', email);
      fd.append('image', file); // é€™è£¡æ˜¯åŸå§‹ File ç‰©ä»¶ï¼ˆbinaryï¼‰

      submitBtn.disabled = true;
      submitBtn.textContent = 'â³ ä¸Šè¼‰ä¸­...';

      try {
        const res = await fetch(webhookUrl, {
          method: 'POST',
          body: fd       // **ä¸è¦è‡ªè¡Œè¨­å®š Content-Type**
        });

        if (res.ok) {
          showStatus('âœ… ä¸Šè¼‰æˆåŠŸï¼ç¨å¾Œæœƒæ”¶åˆ°è™•ç†çµæœé›»éƒµã€‚', false);
          // å¯é¸: é‡ç½®è¡¨å–®
          // document.getElementById('authCode').value = '';
          // document.getElementById('email').value = '';
          // fileInput.value = ''; preview.style.display='none'; fileName.textContent='å°šæœªé¸æ“‡æª”æ¡ˆ';
        } else {
          showStatus('âŒ ä¼ºæœå™¨å›æ‡‰éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚', true);
        }
      } catch (err) {
        showStatus('âŒ ç¶²è·¯éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥é€£ç·šæˆ–ç¨å¾Œå†è©¦ã€‚', true);
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'ğŸš€ ç«‹å³æäº¤';
      }
    };

    function showStatus(msg, isError) {
      statusBox.textContent = msg;
      statusBox.className = isError ? 'err' : 'ok';
      statusBox.style.display = 'block';
    }
  </script>
</body>
</html>

